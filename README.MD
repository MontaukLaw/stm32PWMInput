基于原子的代码, 改了一下定时器与通道.